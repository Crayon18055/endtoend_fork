# 项目说明

原始数据集，经过筛选后保存到 `filtered_data/`目录下，分为不同批量和类型的文件夹，每个文件夹下包含train和val两组数据，val是测试集，占该文件夹数据总数的10%。

在`train.py`中配置选择数据集及最大数据量，或者可选预训练权重，`batch_size`等， 训练默认执行`1000 epoch`， 运行过程中随时可以`ctrl+C`终止，结束`1000 epoch`和`ctrl+C`终止都会保存当前权重，后缀为保存时间的时间戳，保存到 `checkpoints/xxx.pth`。

`datafilter`可以从原始数据集中过滤输出全为`[0，0]`的数据，但已过时,未更新，最新的过滤包含更多方式和内容。

本仓库提供三中测试方式
`test.py` ：从所选数据集中抽取8张图片，显示并将模型输入输出以及参考输出打印在图片上，同时覆盖一层`transformer encoder`的第一层的注意力热力图，越亮的点表示注意力越高，透明度可调。用于直接观察模型输出的准确度。

`test_for_different_goal.py`：从所选数据集中随机抽取8张图，将机器人前方的半圆的九个`local_goal`分别输出，并将结果一同打印在图片上，用于观察模型是否有根据图片内容改变策略的能力。

`evacuate.py`：使用所选数据集的全部数据，对模型输出的结果进行打分，打分标准与`loss`的计算方式相同，因此分数越小代表效果越好。最终输出总分，平均分，和样本数量。用于量化分析模型的准确度。

以上三种测试方式可以直接运行对应文件启动，或者也可以使用`test_gui.py`启动一个窗口，方便选择所需的，各种参数和配置，避免反复修改代码本身。
